<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Mealkitz.io – Historia de tu Punto de Venta</title>
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Bootstrap Icons -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <!-- Google Font -->
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      /* Adjust body padding to accommodate fixed footer alert */
      body {
        font-family: 'Poppins', sans-serif;
        background-color: #f8f9fa;
        padding-top: 1rem;      /* added to match second code */
        padding-bottom: 5rem;
      }

      /* Navbar styling adapted from second code */
      .navbar {
        box-shadow: 0 2px 4px rgba(0,0,0,.08);  /* softer shadow */
        background-color: #fff;
        margin-bottom: 1rem;
      }
      .navbar-brand {
        font-weight: 600;
        color: #123A62 !important;
      }
      .navbar-toggler {
        border: none;  /* remove default border */
      }
      .navbar-toggler-icon {
        /* custom hamburger colored to match brand */
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba(18,58,98,0.8)' stroke-width='2' stroke-linecap='round' stroke-miterlimit='10' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
      }

      .btn, .btn-link {
        outline: none !important;
        box-shadow: none !important;
        border: none !important;
      }
      .btn-primary {
        background-color: #123A62;
        color: #fff;
        border: 2px solid #123A62 !important;
      }
      .btn-secondary {
        background-color: #6c757d;
        color: #fff;
        border: 2px solid #6c757d !important;
      }
      .btn-primary:hover {
        background-color: #0e3150;
        transform: translateY(-2px);
      }
      .btn-secondary:hover {
        background-color: #5a6268;
        transform: translateY(-2px);
      }
      .btn.disabled, .btn:disabled {
        background-color: #6c757d !important;
        border-color: #6c757d !important;
        color: #fff !important;
        cursor: not-allowed !important;
        opacity: 0.65;
      }
      .container-main {
        background: #fff;
        padding: 2rem;
        border-radius: .5rem;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        margin-top: 1rem;
      }
      .modal-body {
        padding: 2rem;
      }
      .form-control, .form-select {
        margin-bottom: 1rem;
      }
      /* Responsive styling for large buttons to take full width on small screens */
      @media (max-width: 767.98px) {
        .btn-lg.full-width-sm {
          display: block;
          width: 100%;
          margin-bottom: 0.5rem;
        }
        .btn-lg.full-width-sm:last-child {
          margin-bottom: 0;
        }
      }
      /* Styles for the main hero section with a blue background */
      .hero-blue-background {
        background-color: #123A62;
        color: #fff;
        padding: 2rem;
        border-radius: .5rem;
        margin-bottom: 1rem;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      }
      .hero-blue-background h1 {
        margin: 0;
        font-weight: normal;
      }
      .hero-blue-background p {
        color: #f1f1f1;
        font-size: 1rem;
      }
      /* Floating footer sign-up alert with slide-up animation */
      #signupAlert {
        position: fixed;
        bottom: -100px;
        left: 50%;
        transform: translateX(-50%);
        width: 100%;
        max-width: 600px;
        z-index: 1050;
        border-radius: 0;
        transition: bottom 0.5s ease-out;
      }
      #signupAlert.visible {
        bottom: 0;
      }

      #navbarIcons.collapsing {
        height: 0;
        overflow: hidden;
        transition: height 0.5s ease-in-out;
      }

      /* Custom Navbar Link Styling (copied from punto.html & datos.html) */
      @media (max-width: 767.98px) { /* Bootstrap's md breakpoint */
        .navbar-collapse .navbar-nav .nav-item {
          text-align: center;
        }
        .navbar-collapse .navbar-nav .nav-link {
          padding-top: 0.75rem;
          padding-bottom: 0.75rem;
        }
        .navbar-collapse .navbar-nav {
          margin-top: 0.5rem;
        }
        .navbar-collapse .navbar-nav.me-auto {
            margin-right: 0 !important;
            margin-left: 0 !important;
            width: 100%;
        }
         .navbar-collapse .d-flex.ms-auto {
            width: 100%;
            justify-content: center;
            margin-top: 0.5rem;
            padding-bottom: 0.5rem;
        }
      }

      @media (min-width: 768px) {
        .navbar-collapse ul.navbar-nav.me-auto {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }
      }

      .navbar-nav .nav-link {
        transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
      }
      .navbar-nav .nav-link:hover,
      .navbar-nav .nav-link:focus {
        background-color: #e9ecef;
        color: #0056b3;
        border-radius: 0.375rem;
      }
      .navbar-nav .nav-link i {
        font-size: 1.1em;
        vertical-align: text-bottom;
        margin-right: 0.35em !important;
      }

      @media (max-width: 575.98px) {
        .card-value {
          font-size: 2.25em; /* Smaller font for mobile */
          margin-bottom: .25rem; /* Reduced margin for mobile */
        }
        .card-label {
          font-size: 0.8rem; /* Even smaller label on mobile */
        }
      }

      .card-label {
        color: #6c757d;
        font-size: 0.9rem;
        text-align: center; /* Added to ensure centering */
      }

      .card-value {
        font-size: 3em;
        margin-bottom: .5rem;
        color: #123A62;
        font-weight: 600;
        text-align: center; /* Added to ensure centering */
      }

      /* Specific styles for hacemos.html sections to be restored/added */

      /* Hero CTA button styling (based on original hacemos.html hero CTA) */
      .btn-cta {
        background-color: #198754; /* Green for CTA */
        color: #ffffff !important; /* Ensure text is white */
        font-weight: 600;
        padding: 0.75rem 2rem;
        border-radius: 0.5rem;
        transition: background-color 0.2s, transform 0.2s;
        text-decoration: none; /* Ensure no underline if it's an <a> tag */
      }
      .btn-cta:hover {
        background-color: #157347; /* Darker green on hover */
        color: #ffffff !important;
        transform: translateY(-2px);
      }

      /* Features Section */
      .features-section {
        padding: 3rem 1rem;
      }
      .features-section h2 {
        text-align: center;
        color: #123a62;
        margin-bottom: 2rem;
      }
      .feature-card {
        background-color: #ffffff;
        border: none; /* Assuming a borderless look is preferred, aligned with global .btn */
        border-radius: 0.75rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        padding: 1.5rem;
        text-align: center;
        transition: transform 0.2s, box-shadow 0.2s;
      }
      .feature-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      }
      .feature-card i {
        font-size: 2rem;
        color: #198754; /* Green icons for features */
        margin-bottom: 0.75rem;
      }
      .feature-card h5 {
        margin-bottom: 0.5rem;
        color: #123a62;
        font-size: 1.1rem;
        font-weight: 600; /* Ensuring consistent heading weight */
      }
      .feature-card p {
        color: #6c757d;
        font-size: 0.9rem;
      }

      /* Steps Section */
      .steps-section {
        padding: 3rem 1rem;
        /* background-color: #ffffff; Removed: sections are inside .container-main which has white bg */
        /* border-radius: 0.75rem; Removed: sections are inside .container-main */
        /* box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04); Removed: sections are inside .container-main */
      }
      .steps-section h3 {
        text-align: center;
        color: #123a62;
        margin-bottom: 2rem;
        font-weight: 600; /* Ensuring consistent heading weight */
      }
      .step-card {
        background-color: #fefefe; /* Slight off-white for cards */
        border: 1px solid #e9ecef;
        border-radius: 0.75rem;
        padding: 1.5rem;
        text-align: center;
        transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
        cursor: pointer;
      }
      .step-card:hover {
        transform: translateY(-6px);
        box-shadow: 0 8px 20px rgba(18, 58, 98, 0.15);
        border-color: #123a62;
      }
      .step-card i {
        font-size: 2rem;
        color: #123a62; /* Dark blue icons for steps */
        margin-bottom: 0.75rem;
        transition: color 0.3s ease, transform 0.3s ease;
      }
      .step-card:hover i {
        color: #198754;
        transform: scale(1.1);
      }
      .step-card h5 {
        font-weight: 600;
        margin-bottom: 0.5rem;
        color: #123a62;
        transition: color 0.3s ease;
      }
      .step-card:hover h5 {
        color: #198754;
      }
      .step-card p {
        font-size: 0.9rem;
        color: #6c757d;
        transition: color 0.3s ease;
      }
      .step-card:hover p {
        color: #495057;
      }
      
      /* Make sure anchor tags don't interfere with card styling */
      .steps-section a {
        color: inherit;
        text-decoration: none !important;
      }
      .steps-section a:hover {
        color: inherit;
        text-decoration: none !important;
      }

      /* "Ideal para" List */
      .ideal-section {
        padding: 2rem 1rem;
      }
      .ideal-section h3 {
        text-align: center;
        color: #123a62;
        margin-bottom: 1.5rem;
        font-weight: 600; /* Ensuring consistent heading weight */
      }
      .ideal-section ul li {
        margin-bottom: 0.75rem;
        font-size: 0.95rem;
        font-weight: 400; /* Ensuring consistent paragraph weight */
      }
      .ideal-section ul li i {
        color: #28a745; /* Green checkmark icons */
        margin-right: 0.5rem;
      }

      /* Footer Note Banner */
      .note-banner {
        padding: 1rem;
        background-color: #198754; /* Green banner */
        color: #ffffff;
        text-align: center;
        border-radius: 0.5rem;
        margin-top: 2rem;
      }
    </style>
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-md">
      <div class="container">
        <a class="navbar-brand d-flex align-items-center" href="index.html">
          <img
            href="index.html"
            src="Images/mk_logo.jpeg"
            alt="Mealkitz Logo"
            style="height: 35px; margin-right: 0.5rem;"
          />
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarContent"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarContent">
          <ul class="navbar-nav mx-auto mb-2 mb-md-0">
            <li class="nav-item">
              <a class="nav-link" href="hacemos.html">¿Qué hacemos?</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="punto.html">Mealkitz.io (DEMO)</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="iniciar.html">Iniciar Sesión</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="ayuda.html">Ayuda</a>
            </li>
          </ul>
          <a href="#" class="btn btn-primary ms-md-3" data-bs-toggle="modal" data-bs-target="#contactRequestModalHacemos">Comenzar Ahora</a>
        </div>
      </div>
    </nav>

    <!-- Hero Section -->
    <main class="container container-main">
      <section class="hero hero-blue-background">
        <h1>Bienvenido a Mealkitz.io</h1>
        <p>Usamos tecnología sencilla y confiable para que emprendedores gastronómicos,
          artesanos y pequeños negocios facturen de forma segura, organicen operaciones
          y comprendan sus finanzas para crecer.</p>
        <a href="#" class="btn btn-cta" data-bs-toggle="modal" data-bs-target="#contactRequestModalHacemos">Comenzar Ahora</a>
      </section>

    <!-- Features Section -->
    <section class="features-section">
      <div class="container">
        <h2>Lo que puedes hacer con Mealkitz.io</h2>
        <div class="row g-4">
          <!-- Card 1: Punto de Venta -->
          <div class="col-12 col-sm-6 col-md-3">
            <a href="merchant.html" class="feature-link text-decoration-none" data-feature="pos">
              <div class="feature-card h-100">
                <i class="bi bi-calculator-fill"></i>
                <h5>Punto de Venta</h5>
                <p>Administra ventas en tienda o eventos con interfaz intuitiva. Registra transacciones, pagos y descuentos. Todo integrado para tu control.</p>
              </div>
            </a>
          </div>
          <!-- Card 2: Mi Tienda en Línea -->
          <div class="col-12 col-sm-6 col-md-3">
            <a href="merchant.html" class="feature-link text-decoration-none" data-feature="ecommerce">
              <div class="feature-card h-100">
                <i class="bi bi-shop-window"></i>
                <h5>Mi Tienda en Línea</h5>
                <p>Define apariencia, gestiona catálogo online y configura cómo clientes te encuentran y compran en internet. Lanza tu vitrina digital.</p>
              </div>
            </a>
          </div>
          <!-- Card 3: Documentos Financieros -->
          <div class="col-12 col-sm-6 col-md-3">
            <a href="merchant.html" class="feature-link text-decoration-none" data-feature="docs">
              <div class="feature-card h-100">
                <i class="bi bi-files"></i>
                <h5>Documentos Financieros</h5>
                <p>Profesionaliza tu negocio. Crea y envía cotizaciones, emite órdenes de compra y genera facturas electrónicas cumpliendo requisitos fiscales.</p>
              </div>
            </a>
          </div>
          <!-- Card 4: Pedidos -->
          <div class="col-12 col-sm-6 col-md-3">
            <a href="merchant.html" class="feature-link text-decoration-none" data-feature="orders">
              <div class="feature-card h-100">
                <i class="bi bi-box-seam"></i>
                <h5>Gestión de Pedidos</h5>
                <p>Controla todas tus ventas. Accede a un resumen consolidado de pedidos de tu punto de venta y tienda en línea.</p>
            </div>
            </a>
          </div>
          <!-- Card 5: CRM -->
          <div class="col-12 col-sm-6 col-md-3">
            <a href="merchant.html" class="feature-link text-decoration-none" data-feature="crm">
              <div class="feature-card h-100">
                <i class="bi bi-people-fill"></i>
                <h5>CRM (Clientes)</h5>
                <p>Construye relaciones duraderas. Registra y organiza datos de clientes, su historial de compras para un servicio personalizado y leal.</p>
              </div>
            </a>
          </div>
          <!-- Card 6: Inversión -->
          <div class="col-12 col-sm-6 col-md-3">
            <a href="merchant.html" class="feature-link text-decoration-none" data-feature="investment">
              <div class="feature-card h-100">
                <i class="bi bi-currency-dollar"></i>
                <h5>Herramientas de Inversión</h5>
                <p>Planifica el futuro financiero. Analiza costos, proyecta ingresos y evalúa oportunidades de inversión que impulsen el crecimiento de tu negocio.</p>
              </div>
            </a>
          </div>
          <!-- Card 7: Analítica de Negocio -->
          <div class="col-12 col-sm-6 col-md-3">
            <a href="merchant.html" class="feature-link text-decoration-none" data-feature="analytics">
              <div class="feature-card h-100">
                <i class="bi bi-graph-up-arrow"></i>
                <h5>Analítica de Negocio</h5>
                <p>Toma decisiones basadas en datos. Visualiza reportes claros sobre ventas, productos y tendencias para optimizar estrategias y rendimiento.</p>
              </div>
            </a>
          </div>
          <!-- Card 8: Configuración -->
          <div class="col-12 col-sm-6 col-md-3">
            <a href="merchant.html" class="feature-link text-decoration-none" data-feature="config">
              <div class="feature-card h-100">
                <i class="bi bi-sliders"></i>
                <h5>Configuración</h5>
                <p>Adapta Mealkitz.io a tu medida. Personaliza información, productos, pagos y otros ajustes de la plataforma como lo necesites.</p>
              </div>
            </a>
          </div>
        </div>
      </div>
    </section>

    <!-- Ideal Para Section -->
    <section class="ideal-section">
      <div class="container">
        <h3>Ideal para</h3>
        <div class="row gx-4 gy-3">
          <div class="col-6 col-md-3">
            <ul class="list-unstyled">
              <li><i class="bi bi-check-circle-fill"></i>Bakery casera</li>
              <li><i class="bi bi-check-circle-fill"></i>Food truck</li>
              <li><i class="bi bi-check-circle-fill"></i>Restaurante pop-up</li>
            </ul>
          </div>
          <div class="col-6 col-md-3">
            <ul class="list-unstyled">
              <li><i class="bi bi-check-circle-fill"></i>Cocina oculta</li>
              <li><i class="bi bi-check-circle-fill"></i>Catering pequeño</li>
              <li><i class="bi bi-check-circle-fill"></i>Artesanías alimenticias</li>
            </ul>
          </div>
          <div class="col-6 col-md-3">
            <ul class="list-unstyled">
              <li><i class="bi bi-check-circle-fill"></i>Jabones y cremas</li>
              <li><i class="bi bi-check-circle-fill"></i>Consultoría</li>
              <li><i class="bi bi-check-circle-fill"></i>Chef privado</li>
            </ul>
          </div>
          <div class="col-6 col-md-3">
            <ul class="list-unstyled">
              <li><i class="bi bi-check-circle-fill"></i>Talleres de cocina</li>
              <li><i class="bi bi-check-circle-fill"></i>Fonda</li>
              <li><i class="bi bi-check-circle-fill"></i>Almuerzos corporativos</li>
            </ul>
          </div>
        </div>
      </div>
      </section>

    <!-- Steps Section -->
    <section class="steps-section mx-auto my-5" style="max-width: 900px;">
      <h3>Paso a Paso</h3>
      <div class="row g-4">
        <div class="col-12 col-sm-6 col-lg-3">
          <a href="iniciar.html?action=register" class="text-decoration-none">
            <div class="step-card h-100">
              <i class="bi bi-person-plus-fill"></i>
              <h5>1. Regístrate</h5>
              <p>Regístrate gratis con nombre, correo y contraseña.</p>
            </div>
          </a>
        </div>
        <div class="col-12 col-sm-6 col-lg-3">
          <a href="iniciar.html?action=register" class="text-decoration-none">
            <div class="step-card h-100">
              <i class="bi bi-gear-fill"></i>
              <h5>2. Configura tu negocio</h5>
              <p>Agrega ubicación, datos fiscales y catálogo de productos.</p>
            </div>
          </a>
        </div>
        <div class="col-12 col-sm-6 col-lg-3">
          <a href="iniciar.html?action=register" class="text-decoration-none">
            <div class="step-card h-100">
              <i class="bi bi-receipt-cutoff"></i>
              <h5>3. Factura</h5>
              <p>Emite facturas electrónicas con validación automática.</p>
            </div>
          </a>
        </div>
        <div class="col-12 col-sm-6 col-lg-3">
          <a href="iniciar.html?action=register" class="text-decoration-none">
            <div class="step-card h-100">
              <i class="bi bi-basket3-fill"></i>
              <h5>4. Gestiona pedidos</h5>
              <p>Centraliza pedidos, controla inventario y reportes en tiempo real.</p>
            </div>
          </a>
        </div>
      </div>
    </section>

    <!-- NEW Bottom Call to Action Button -->
    <section class="final-cta-section text-center py-5">
      <div class="container">
        <a href="#" class="btn btn-cta btn-lg" data-bs-toggle="modal" data-bs-target="#contactRequestModalHacemos">Comenzar Ahora</a>
      </div>
    </section>
    <!-- END NEW Bottom Call to Action Button -->

    <!-- MODALS SECTION -->
    <!-- Contact Request Modal (New) -->
    <div class="modal fade" id="contactRequestModalHacemos" tabindex="-1" aria-labelledby="contactRequestModalLabelHacemos" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="contactRequestModalLabelHacemos">Contáctanos para Más Información</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
          </div>
          <div class="modal-body">
            <form id="contactRequestFormHacemosModal">
              <div class="mb-3">
                <label for="contactNameHacemosModal" class="form-label">Nombre Completo<span class="text-danger">*</span></label>
                <input type="text" class="form-control" id="contactNameHacemosModal" required>
              </div>
              <div class="mb-3">
                <label for="contactEmailHacemosModal" class="form-label">Correo Electrónico<span class="text-danger">*</span></label>
                <input type="email" class="form-control" id="contactEmailHacemosModal" required>
              </div>
              <div class="mb-3">
                <label for="contactWhatsappHacemosModal" class="form-label">Número de WhatsApp (Opcional)</label>
                <input type="tel" class="form-control" id="contactWhatsappHacemosModal" placeholder="+123 4567890">
              </div>
              <div class="mb-3">
                <label for="contactMessageHacemosModal" class="form-label">Mensaje (Opcional)</label>
                <textarea class="form-control" id="contactMessageHacemosModal" rows="4" placeholder="Escribe tu consulta aquí..."></textarea>
              </div>
              <div id="contactFormFeedbackHacemosModal" class="mt-3 mb-3"></div>
              <!-- Early Adopter Incentive Text -->
              <p class="text-center text-muted small mb-3">
                <strong>¡Sé uno de los primeros 100 en transformar tu negocio con Mealkitz.io!</strong><br>
                Déjanos tus datos y te contactaremos con acceso prioritario.
              </p>
              <!-- End Early Adopter Incentive Text -->
              <div class="text-center">
                <button type="submit" class="btn btn-primary btn-lg">Enviar Consulta</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Registro Modal -->
    <div
      class="modal fade"
      id="comenzarRegistroModal"
      tabindex="-1"
      aria-labelledby="comenzarRegistroModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="comenzarRegistroModalLabel">
              Regístrate con Mealkitz
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Cerrar"
            ></button>
          </div>
          <div class="modal-body">
            <form id="comenzarRegistroForm">
              <div class="row g-3">
                <div class="col-12">
                  <label for="registroNombreCompleto" class="form-label"
                    >Nombre Completo<span class="text-danger">*</span></label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="registroNombreCompleto"
                    required
                  />
                </div>
                <div class="col-12">
                  <label for="registroNombreNegocio" class="form-label"
                    >Nombre de Negocio<span class="text-danger">*</span></label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="registroNombreNegocio"
                    required
                  />
                </div>
                <div class="col-12">
                  <label for="registroTipoNegocio" class="form-label"
                    >Tipo de Negocio<span class="text-danger">*</span></label
                  >
                  <select
                    class="form-select"
                    id="registroTipoNegocio"
                    required
                  >
                    <option value="" disabled selected>Selecciona uno...</option>
                    <option value="Emprendedor Gastronómico">
                      Emprendedor Gastronómico
                    </option>
                    <option value="Artesano">Artesano</option>
                    <option value="Pequeño Negocio">Pequeño Negocio</option>
                    <option value="Restaurante/Cafetería">
                      Restaurante / Cafetería
                    </option>
                    <option value="Food Truck">Food Truck</option>
                    <option value="Otro">Otro</option>
                  </select>
                </div>
                <div class="col-12">
                  <label for="registroEmail" class="form-label"
                    >Correo Electrónico<span class="text-danger">*</span></label
                  >
                  <input
                    type="email"
                    class="form-control"
                    id="registroEmail"
                    required
                  />
                </div>
                <div class="col-12">
                  <label for="registroTelefono" class="form-label"
                    >Teléfono (WhatsApp)<span class="text-danger">*</span></label
                  >
                  <input
                    type="tel"
                    class="form-control"
                    id="registroTelefono"
                    placeholder="+507 6xxxxxxx"
                    required
                  />
                </div>
                <div class="col-12">
                  <label for="registroMensaje" class="form-label"
                    >Mensaje (Opcional)</label
                  >
                  <textarea
                    class="form-control"
                    id="registroMensaje"
                    rows="2"
                    placeholder="Cuéntanos tus necesidades..."
                  ></textarea>
                </div>
              </div>
              <div id="registroFormFeedback" class="mt-3"></div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <button type="submit" form="comenzarRegistroForm" class="btn btn-primary">
              Enviar Solicitud
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Login Required Modal -->
    <div
      class="modal fade"
      id="loginRequiredModal"
      tabindex="-1"
      aria-labelledby="loginRequiredModalLabel"
      aria-hidden="true"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="loginRequiredModalLabel">
              <i class="bi bi-exclamation-triangle-fill text-warning me-2"></i>
              Inicio de Sesión Requerido
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Cerrar"
            ></button>
          </div>
          <div class="modal-body">
            <p>
              Para acceder a esta función, por favor, inicia sesión o crea una
              cuenta.
            </p>
          </div>
          <div class="modal-footer justify-content-center">
            <a href="iniciar.html" class="btn btn-primary">Iniciar Sesión</a>
            <a href="iniciar.html?action=register" class="btn btn-secondary">
              Crear Cuenta
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/auth-navbar.js" defer></script>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const loginRequiredModalEl = document.getElementById('loginRequiredModal');
        const loginRequiredModalInstance = loginRequiredModalEl ? new bootstrap.Modal(loginRequiredModalEl) : null;
        let postLoginRedirectData = null;

        try {
            const postLoginRedirectRAW = sessionStorage.getItem('postLoginRedirect');
            if (postLoginRedirectRAW) {
                postLoginRedirectData = JSON.parse(postLoginRedirectRAW);
            }
        } catch (e) {
            console.error("Error parsing postLoginRedirect from sessionStorage (hacemos.html):", e);
            sessionStorage.removeItem('postLoginRedirect'); // Clear corrupted data
        }

        const currentUser = localStorage.getItem('currentUser_mealkitz');

        const commonLoginCheck = (event, destination) => {
            if (!currentUser) {
                if (event) event.preventDefault();
                if (loginRequiredModalInstance) {
                    sessionStorage.setItem('postLoginRedirect', JSON.stringify(destination));
                    loginRequiredModalInstance.show();
                } else {
                    console.error('Login Required Modal not found/initialized on hacemos.html.');
                    window.location.href = 'iniciar.html'; 
                }
                return false;
            }
            return true;
        };

        if (postLoginRedirectData && postLoginRedirectData.page === 'hacemos.html' && postLoginRedirectData.hash && currentUser) {
            const targetModalId = postLoginRedirectData.hash.substring(1);
            const modalElement = document.getElementById(targetModalId);
            if (modalElement && bootstrap.Modal) {
                const modalInstance = bootstrap.Modal.getInstance(modalElement) || new bootstrap.Modal(modalElement);
                if (modalInstance) modalInstance.show();
            }
            sessionStorage.removeItem('postLoginRedirect');
        }

        const navbarRegistrateBtn = document.querySelector('.navbar .btn-primary.ms-md-3');
        if (navbarRegistrateBtn) {
            if (navbarRegistrateBtn.getAttribute('data-bs-target') === '#contactRequestModalHacemos') {
                // If it's already set up for the modal, we might not need to attach commonLoginCheck, 
                // or ensure any old one for 'punto.html' is removed.
                // For now, we assume this button, once changed to open a modal, does not need commonLoginCheck.
                // If a previous event listener for commonLoginCheck was attached to this specific element and needs removal,
                // it would require storing a reference to that specific listener function, which is not currently done.
                // By changing its href and adding modal attributes, its old navigation purpose is overridden.
            } else if (navbarRegistrateBtn.getAttribute('href') === 'punto.html') {
                 // This block would have been for the old button linking to punto.html.
                 // We are effectively removing this behavior by changing the button's attributes above.
                 // So, no specific commonLoginCheck for 'punto.html' needed for this button anymore.
            }
        }

        const navbarDemoLink = document.querySelector('.navbar-nav a[href="punto.html"]:not(.btn-primary)');
        if (navbarDemoLink) {
            navbarDemoLink.addEventListener('click', function(event) {
                if (!commonLoginCheck(event, { page: 'punto.html', hash: '#manualChargeModal' })) return;
            });
        }
        
        const heroComenzarBtn = document.querySelector('.hero .btn-cta[data-bs-target="#contactRequestModalHacemos"]');
        if (heroComenzarBtn) {
            // Remove previous commonLoginCheck if it was targeting direct navigation
            // This part is tricky without knowing exactly how it was attached. For now, we assume
            // the new behavior (modal toggle) doesn't need commonLoginCheck.
            // If login IS required before opening this contact modal, the logic would need to be different.
        }

        const featureLinkTargets = {
            "pos": { page: 'merchant.html', hash: '#basicPosModal' },
            "ecommerce": { page: 'merchant.html', hash: '#eCommerceAdminModal' },
            "docs": { page: 'merchant.html', hash: '#documentCreationModal' },
            "orders": { page: 'merchant.html', hash: '#pedidosSummaryModal' },
            "crm": { page: 'merchant.html' }, 
            "investment": { page: 'merchant.html' }, 
            "analytics": { page: 'merchant.html' }, 
            "config": { page: 'merchant.html' }  
        };

        document.querySelectorAll('.feature-link[href="merchant.html"][data-feature]').forEach(link => {
            const featureKey = link.dataset.feature;
            if (featureLinkTargets[featureKey]) {
                link.addEventListener('click', function(event) {
                    if (!commonLoginCheck(event, featureLinkTargets[featureKey])) return;
                    // If commonLoginCheck is true, default navigation to merchant.html occurs.
                    // The hash for opening a modal will be handled by merchant.html's own logic 
                    // when it processes postLoginRedirectData.
                });
            }
        });
        
        const contactRequestFormElHacemosModal = document.getElementById('contactRequestFormHacemosModal');
        const contactFormFeedbackElHacemosModal = document.getElementById('contactFormFeedbackHacemosModal');
        // const contactRequestModalInstance = document.getElementById('contactRequestModalHacemos') ? new bootstrap.Modal(document.getElementById('contactRequestModalHacemos')) : null;

        if (contactRequestFormElHacemosModal && contactFormFeedbackElHacemosModal) {
            contactRequestFormElHacemosModal.addEventListener('submit', function(event) {
                event.preventDefault();
                const contactName = document.getElementById('contactNameHacemosModal').value;
                const contactEmail = document.getElementById('contactEmailHacemosModal').value;
                const contactWhatsapp = document.getElementById('contactWhatsappHacemosModal').value;
                const contactMessage = document.getElementById('contactMessageHacemosModal').value;

                const formData = {
                    name: contactName,
                    email: contactEmail,
                    whatsapp: contactWhatsapp,
                    message: contactMessage,
                    source: 'hacemos.html contact MODAL',
                    timestamp: new Date().toISOString()
                };

                console.log("Nueva Consulta de Contacto (hacemos.html MODAL):", formData);
                
                contactFormFeedbackElHacemosModal.innerHTML = '<div class="alert alert-success" role="alert">¡Gracias por tu consulta! Nos pondremos en contacto contigo pronto.</div>';
                contactRequestFormElHacemosModal.reset();

                setTimeout(() => {
                    if (contactFormFeedbackElHacemosModal) contactFormFeedbackElHacemosModal.innerHTML = '';
                    // Optionally close the modal after success:
                    // const modalToClose = bootstrap.Modal.getInstance(document.getElementById('contactRequestModalHacemos'));
                    // if (modalToClose) modalToClose.hide();
                }, 6000); // Clear feedback after 6 seconds
            });
        }
      });
    </script>

    <footer class="text-center py-3 mt-auto bg-light">
      <div class="container d-flex justify-content-center align-items-center">
        
        <span class="text-muted small">Powered by</span> <img src="images/mk_logo.jpeg" alt="Mealkitz Logo" style="height: 24px; width: auto; margin-right: 8px;">
      </div>
    </footer>

  </body>
</html>
